from __future__ import print_function, division, absolute_import

# run this in a notebook to plot

from b2problem_validator import B2ProblemValidator
from params import getDefaultParamValues, getBestKnownValues
from numpy import array

values = \
    array([ -3.35166739,  -4.73807435,   2.48319019,  -2.66188933,
        -2.02441197,   2.09068995,  -2.19131777,   1.04933437,
         0.97311014,   1.90374487,  -3.55075697,   2.73280305,
        -5.60271754,  -1.44821677,   0.03984119,  -1.90926666,
        -0.29670117, -10.76064972,   7.59473972,   5.09370655,
         0.88592209,   1.80884683,   3.25712347,   0.58532929,
        -2.91622038,  -2.11091937,   1.41309467,   4.37838622,
        -2.57445035,  -3.62689247,   3.68312148,  -2.1614904 ,
        -2.19422997,  -0.71967873,   1.22105356,  -1.8180843 ,
        -0.96623582,  -0.35315663,   7.24149161,  -1.58870488,
        -3.4428465 ,  -1.26880289,  -3.9725385 ,  -0.16970606,
        -1.92408369,  -0.04212664,  -0.65100234,  -1.59719423,
        -2.58737772,   3.88661043,  -0.81716197,  -1.9229869 ,
         7.67413797,  -4.06207681,   6.50245399,  -0.23443871,
         2.38027026,  -1.31127531,  -0.6483844 ,   0.26926833,
         0.56276475,  -0.08193972,   1.04814696,  -0.80846117,
         2.7151062 ,  -1.07121362,   1.07417496,  16.45369535,
         5.94799108,  -0.30651665,  -2.64946205,  -1.72501275,
         1.50190224,  -1.44317687,  -1.50478992,   2.02857481,
        -0.16575465,  -2.20363317,   1.57279535,   1.19491737,
         0.28230676,   1.64573026,   2.12944775,   0.86693703,
         0.87537945,   0.57960781,   2.96503297,  -2.88869132,
         5.79937571,  -4.37434006,  -5.44527019,   0.99682078,
         7.23556654,  -6.32706927,  -8.71861234,   1.12685515,
         7.91303253,   3.36113062,   6.30398441,   9.01327757,
        -0.60621481,   4.84610945,  -3.38678146,   8.14677561,
         0.61876624,  -5.34325226,   0.90930014,  -3.24443644,
        -4.60883424,  -2.28940141,   1.38708649,   4.84868478,
         1.29077341,   5.33699526,  -5.875061  ,  -2.01568049])


n=100
with open('../../../../../sbml/b2.xml') as f:
    sbml = f.read()
m = B2ProblemValidator(sbml, n)
print('evaluate:', m.evaluate(values))
for q in ['cpep', 'cg6p', 'cpyr', 'cf6p', 'cglcex', 'cg1p', 'cpg', 'cfdp', 'cgap']:
    m.plotQuantity(identifier=q, param_values=values, n=n)
