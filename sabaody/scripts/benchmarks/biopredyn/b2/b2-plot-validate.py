from __future__ import print_function, division, absolute_import

# run this in a notebook to plot

from b2problem_validator import B2ProblemValidator
from params import getDefaultParamValues, getBestKnownValues
from numpy import array

# 2000
values = \
    array([ -3.28035958,  -4.27042242,   2.23011274,  -1.64936531,
            -2.23868977,   0.72271439,  -1.57101021,   0.23245169,
            -0.10315206,   1.89512822,  -3.55884121,   1.54431628,
            -4.01089313,   0.4763088 ,  -0.34440757,  -1.95669255,
             0.82259544, -10.66766974,   7.03623766,   4.23337034,
             0.49893063,   2.34418538,   3.88179568,   0.41016565,
            -1.21943503,  -1.81828273,   1.96450082,   5.31400447,
            -2.62226611,  -4.49456431,   3.85559772,  -2.34578588,
            -1.99420086,  -1.17512632,   0.65463372,  -2.03257536,
            -2.63047441,  -0.74800676,   7.04810548,  -1.03617929,
            -2.32626459,  -0.71905111,  -4.44737353,  -0.75270916,
            -1.68780446,  -1.50276793,  -2.46405598,  -1.35698461,
            -1.05832126,   2.44313459,  -1.38843957,  -1.07313989,
             8.20214439,  -5.54327566,   5.86857333,  -0.19186086,
             1.80415183,  -1.72666701,   0.40887581,  -0.35769975,
             0.38622433,   0.18208686,  -0.48106999,   0.27874579,
             1.61052053,  -0.2021316 ,   2.0862551 ,  14.64306213,
             7.6556601 ,   0.20470327,  -2.27293468,  -1.51618676,
             0.91378514,  -3.17945075,  -1.04015155,   0.15174082,
            -0.49980703,  -1.75954124,   1.24755182,   0.39458558,
            -0.10913775,   1.45445814,   2.33450861,   0.91156271,
             1.08201679,   1.55280384,   2.58353885,  -2.7140705 ,
             6.58834529,  -4.18934125,  -3.99586392,  -0.239474  ,
             6.60169728,  -5.8747592 ,  -8.0342739 ,   1.53669213,
             6.99929735,   3.64816694,   6.4895849 ,   7.85308357,
            -1.13699902,   5.35473198,  -2.11826073,   9.77382412,
             1.10728888,  -3.85987334,   1.86185877,  -4.37815023,
            -3.82691982,  -2.69552898,   1.68644653,   4.45022719,
             2.61541838,   4.45899592,  -7.39036913,  -1.40512756])
    # array([ -3.52473701,  -5.2440125 ,   2.16297016,  -1.66047827,
    #         -3.26423066,   0.57785942,  -2.79754547,   0.95405428,
    #         -0.3095724 ,   3.17361531,  -3.58358924,   1.76709445,
    #         -4.98879442,  -0.43549024,   0.24740792,  -1.73174087,
    #         -0.48110152, -10.54158237,   6.35975276,   5.74972268,
    #          1.3977444 ,   1.19769868,   3.25706167,   0.75292973,
    #         -1.47907918,  -1.1394665 ,   1.98160284,   5.8517364 ,
    #         -2.62375334,  -4.47149961,   3.74984022,  -1.98293767,
    #         -2.22929649,  -1.10554517,   1.94852576,  -0.90049391,
    #         -1.78905427,   0.35857672,   6.71638601,  -1.19552356,
    #         -3.16054003,  -1.04596742,  -3.9844806 ,  -0.17777593,
    #         -1.34799444,  -1.68398459,  -2.25910282,  -1.46067796,
    #         -1.40942746,   3.76321018,  -2.33371934,  -1.53125239,
    #          7.9214911 ,  -4.20315444,   4.94590087,  -0.16176041,
    #          2.21812191,  -2.25386072,   0.27791923,  -0.91261406,
    #         -0.73682438,   0.42766549,  -0.35086141,   0.25399007,
    #          1.35709467,  -0.62691965,   1.34410697,  16.16425581,
    #          6.48166491,   1.08010205,  -1.95167047,  -1.82388917,
    #         -0.15146707,  -2.14738362,  -0.53295436,   0.90377777,
    #          0.26784039,  -0.72918626,   1.70023787,   0.78170465,
    #          0.21544663,   1.03225731,   2.64733957,   1.66571625,
    #          0.96733357,   1.24217935,   2.07579793,  -2.55270756,
    #          5.13847636,  -5.22667981,  -4.44641882,  -0.22391068,
    #          7.05460785,  -5.56243366,  -8.59826616,   2.71913592,
    #          7.06677906,   2.13265712,   6.19082559,   8.64906279,
    #         -0.50119033,   4.81504291,  -1.97623312,   8.35211483,
    #          1.2889902 ,  -3.43831197,   2.38600466,  -3.96722301,
    #         -3.01218832,  -2.45315671,   3.08787579,   5.17025847,
    #          2.06554142,   4.14389446,  -7.52494508,  -2.9353398 ])
    # array([-3.11030636e+00, -4.79804927e+00,  1.48751411e+00, -1.85108409e+00,
    #        -1.46863040e+00,  1.48672198e+00, -1.60963305e+00,  6.21335812e-01,
    #         2.16540365e-01,  2.25960320e+00, -4.07179057e+00,  2.81359351e+00,
    #        -4.85233564e+00, -9.43881992e-01, -1.32486542e+00, -1.02964792e+00,
    #        -3.93174331e-01, -1.13246065e+01,  7.02819839e+00,  5.05737755e+00,
    #         1.81682245e+00,  1.43443956e+00,  2.53617091e+00,  4.16272160e-01,
    #        -2.45949114e+00, -1.16098656e+00,  1.31759322e+00,  4.45441956e+00,
    #        -3.34282511e+00, -5.20856707e+00,  3.38612068e+00, -2.37317482e+00,
    #        -9.61595803e-01, -9.35296590e-01,  1.21355814e+00, -1.90660465e+00,
    #        -1.06054882e+00, -7.99858777e-01,  7.34074939e+00, -9.33563589e-01,
    #        -3.92200305e+00, -1.57865239e+00, -5.14247704e+00,  4.78516051e-01,
    #        -1.91955584e+00, -1.35702273e+00, -1.96980804e+00, -1.52249616e+00,
    #        -2.60169046e+00,  2.36515239e+00, -1.75403716e+00, -1.01900852e+00,
    #         7.86784644e+00, -4.02039858e+00,  4.94527616e+00,  8.05192973e-01,
    #         7.58046580e-01, -2.05660038e+00,  6.07091245e-01, -2.14936412e-01,
    #         4.70256230e-01,  9.99854714e-01,  5.72870400e-01,  7.98617335e-04,
    #         1.75644747e+00, -7.88420550e-01,  7.90966650e-01,  1.45754836e+01,
    #         5.93240145e+00,  1.46584551e+00, -2.89260283e+00, -1.87427952e+00,
    #        -3.82039832e-02, -2.53803524e+00, -1.41642190e+00,  1.23475853e+00,
    #        -2.16323049e-01, -1.50191983e+00,  3.42932109e-01,  1.95199367e-04,
    #        -2.76023519e-01,  1.62944388e+00,  2.72102789e+00,  1.06018078e+00,
    #         1.42052642e+00,  7.53441423e-01,  2.34638842e+00, -2.90019346e+00,
    #         6.12289924e+00, -5.16027998e+00, -4.79588514e+00, -2.22619289e-01,
    #         7.41540887e+00, -6.84166286e+00, -7.56431729e+00,  8.50510972e-01,
    #         8.27956038e+00,  2.80200805e+00,  6.58729068e+00,  7.78018215e+00,
    #         8.09551725e-01,  4.19164854e+00, -3.77409893e+00,  9.62369450e+00,
    #         6.58487254e-01, -4.74712860e+00,  2.82599684e+00, -4.47722002e+00,
    #        -4.49461571e+00, -2.65893358e+00,  3.38373655e+00,  4.54526208e+00,
    #         3.21821340e+00,  3.46615110e+00, -5.99904070e+00, -1.96578693e+00])


n=100
with open('../../../../../sbml/b2.xml') as f:
    sbml = f.read()
m = B2ProblemValidator(sbml, n)
print('evaluate:', m.evaluate(values))
for q in ['cpep', 'cg6p', 'cpyr', 'cf6p', 'cglcex', 'cg1p', 'cpg', 'cfdp', 'cgap']:
    m.plotQuantity(identifier=q, param_values=values, n=n)
